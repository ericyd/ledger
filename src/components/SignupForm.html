<form  on:submit='handleSubmit( event )'>
  {{#if err}}
    {{err}}
  {{/if}}
  <label class="textfield" for="name">
    <input type="text" id="name" name="name"/>
    <span class="textfield__label">Your Name</span>
  </label>
  <label class="textfield" for="username">
    <input type="text" id="username" name="username"/>
    <span class="textfield__label">Username</span>
  </label>
  <label class="textfield" for="password">
    <input type="text" id="password" name="password"/>
    <span class="textfield__label">Password</span>
  </label>
  <br/>
  <input type="submit" value="Sign up" />
</form>

<script>
  const axios = require('axios');
 
  export default {
    data() {
      return {
        err: null
      }
    },
    methods: {
      handleSubmit(e) {
        const self = this;

        e.preventDefault();
        axios.post('/users', {
          name: e.target.elements.name.value,
          username: e.target.elements.username.value,
          password: e.target.elements.password.value
        }).then(response => {
          console.log(response);
          if (response.data.id) {
            localStorage.setItem('auth', response.data.id);
            self.fire('signedUp', {
              // on sign up, balance will be 0 and there will be no transactions
              balance: 0,
              transactions: [],
              id: response.data.id
            });
          } else {
            self.set({err: response.data.error});
          }
        }).catch(err => {
          self.set({err: err.message});
        })
      }
    }
  }
</script>